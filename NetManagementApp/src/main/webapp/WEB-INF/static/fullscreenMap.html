<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Google maps fullscreen</title>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0;
        padding: 0;
      }

    </style>
    <link href="resources/css/bootstrap.css" rel='stylesheet' type='text/css' />
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="resources/js/jquery-1.11.1.min.js"></script>
<link href="resources/css/jquery-ui.css" rel='stylesheet' type='text/css' />
<script src="resources/js/jquery-ui.js"></script>
<script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDs4dOADqTQ3psNiKaZ3jEncIaJzBpBWUQ">
    </script>
    
<script type="text/javascript" src="resources/js/gmaps.js"></script>    	
<script type="text/javascript">

var map = null;
function fullMarkers(apdata) {
	
	
	var latlng = null;

	$.each(apdata,function(i,item){
		
		if(i==0) {
			
			var mapOptions = {
 		    		zoom: 8,
 		    		center: latlng,
 		    		mapTypeId: google.maps.MapTypeId.TERRAIN
 		 		 };
 		      	
 		 		 map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);
		}
		var marker = new google.maps.Marker({
            position: latlng,
            map: map,
           title: item.ssid,
            animation: google.maps.Animation.DROP,
        });
 		
 		var content = "SSID: " + item.ssid + "\n" + " Mean RSSI: " + item.rssi + "\n" + '</h3>' + " frequency: " + item.frequency;     

		var infowindow = new google.maps.InfoWindow();

			google.maps.event.addListener(marker,'click', (function(marker,content,infowindow){ 
			        return function() {
			           infowindow.setContent(content);
			           infowindow.open(map,marker);
			        };
			    })(marker,content,infowindow)); 
		
    });
}
 
 function fullPolyline(apdata) {
	 
	 
	 if(map == null) {
		 
		 fullMarkers(apdata);
		 
	 }
	 else {
		 var flightPlanCoordinates = [];
		 $.each(apdata,function(i,item){
			 
			 flightPlanCoordinates.push(new google.maps.LatLng(item.APlatitude, item.APlongtitude));
				
				
			});

	 }

	var flightPath = new google.maps.Polyline({
		path: flightPlanCoordinates,
		geodesic: true,
		strokeColor: '#FF0000',
		strokeOpacity: 1.0,
		strokeWeight: 2
		});
	flightPath.setMap(map);
		
	 
 }
 
 
function fullCells(bsdata) {
	
	
	
	
}


function fullSP(data)
{
var latlng = null;
	
	if(data == null){
		console.log('Data is null');
		 //data = JSON.parse(sessionStorage.getItem('stay-points'));
	}
	else {
		
		if(mapSP == null)
		{ /* Create the map if it does not exists */
			console.log('Map is null');
			for(var item in data) {
				latlng = new google.maps.LatLng(item.lat, item.lon);
				break;
			}
			var mapOptions = {
			    		zoom: 3,
			    		center: latlng,
			    		mapTypeId: google.maps.MapTypeId.TERRAIN
			 		 };
			      	
			  mapSP = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);
		}
		console.log('mapSP: ', mapSP);
		/*var pinColor = "0000FF";
		var pinImage = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + pinColor,
		        new google.maps.Size(21, 40),
		        new google.maps.Point(0,0),
		        new google.maps.Point(10, 34));*/
		 var marker = null;
		$.each(data,function(i,item){
			
				latlng = new google.maps.LatLng(item.lat, item.lon);
		
				    marker = new google.maps.Marker({
	                position: latlng,
	                map: mapSP,
	               // icon: pinImage,
	               // title: item.Operator,
	                animation: google.maps.Animation.DROP,
	            });
				   
				   
				 
		 		var content = "Tstart: " + item.Tstart +" --- " + " Tend: " + item.Tend;  

	 			var infowindow = new google.maps.InfoWindow();

	 			google.maps.event.addListener(marker,'click', (function(marker,content,infowindow){ 
	 			        return function() {
	 			           infowindow.setContent(content);
	 			           infowindow.open(mapSP,marker);
	 			        };
	 			    })(marker,content,infowindow)); 
				
				
			});
		

		
	}
	console.log('Ending Draw stay points');
	
	
	
	}  
function initialize() {
	
	var currentV = window.opener.view;
	
	if(currentV == 0){
		var apdata = JSON.parse(sessionStorage.getItem('sent'));
		Markers(apdata);
		//fullMarkers(apdata);
	}
	else if(currentV == 1){
		//var apdata = JSON.parse(sessionStorage.getItem('sent'));
		Polyline()
		//fullPolyline(apdata);
		
	}
	else if(currentV == 2) {
		//var bsdata = JSON.parse(sessionStorage.getItem('bs'));
		DrawCells();
	}
	else if(currentV == 3){
		
		
	}
	
	
}
google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>
<body>
<div id="map-canvas"></div>
</body>
</html>